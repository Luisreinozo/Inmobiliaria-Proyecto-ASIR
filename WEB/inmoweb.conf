<VirtualHost *:80>
    ServerName web.inmobiliaria.local
    DocumentRoot /var/www/inmoweb
    
    <Directory /var/www/inmoweb>
        Require all granted
        AllowOverride All
        Options Indexes FollowSymLinks
    </Directory>

    # Zona privada /admin autenticada contra AD (LDAPS Samba4)
    <Directory /var/www/inmoweb/admin>
        AuthType Basic
        AuthName "Backoffice Inmobiliaria (AD)"
        AuthBasicProvider ldap
        
        # URL LDAP con SSL
        AuthLDAPURL "ldaps://dcad.inmobiliaria.local:636/DC=inmobiliaria,DC=local?sAMAccountName?sub?(objectClass=user)"
        
        # Cuenta de servicio para buscar usuarios y grupos
        AuthLDAPBindDN "CN=Ramon,CN=Users,DC=inmobiliaria,DC=local"
        AuthLDAPBindPassword "Ramon0105."
        AuthLDAPRemoteUserIsDN off
        Require valid-user
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/inmoweb_error.log
    CustomLog ${APACHE_LOG_DIR}/inmoweb_access.log combined
</VirtualHost>
